<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Qu·∫£n l√Ω Ng∆∞·ªùi D√πng - Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .navbar { background-color: #2c3e50; }
    .navbar-brand { color: #fff; font-weight: bold; }
    .navbar-brand:hover { color: #f1c40f; }
    header { background: linear-gradient(135deg, #3498db, #8e44ad); color: white; }
    footer { background: #2c3e50; color: white; padding: 20px 0; }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg mb-4">
  <div class="container">
    <a class="navbar-brand" href="admin_dashboard.html">Admin Dashboard</a>
    <button onclick="history.back()" class="btn btn-primary">üîô Quay l·∫°i</button>
  </div>
</nav>

<header class="text-center py-5 mb-4">
  <h1>üë• Qu·∫£n l√Ω Ng∆∞·ªùi D√πng</h1>
  <button class="btn btn-success mt-3" data-bs-toggle="modal" data-bs-target="#addUserModal">‚ûï Th√™m ng∆∞·ªùi d√πng</button>
</header>

<section class="container my-4">
  <table class="table table-bordered align-middle">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Username</th>
        <th>H·ªç t√™n</th>
        <th>Email</th>
        <th>SƒêT</th>
        <th>Quy·ªÅn</th>
        <th>H√†nh ƒë·ªông</th>
      </tr>
    </thead>
    <tbody id="userTableBody">
      <!-- D·ªØ li·ªáu t·ª´ DB s·∫Ω load ·ªü ƒë√¢y -->
    </tbody>
    <tbody>
      <!-- Fake d·ªØ li·ªáu m·∫´u -->
      <tr>
        <td>1</td>
        <td>admin</td>
        <td>Admin B·∫£o T√†ng</td>
        <td>admin@example.com</td>
        <td>0123456789</td>
        <td><span class="badge bg-primary">admin</span></td>
        <td>
          <button class="btn btn-warning btn-sm" onclick="editUser(1, 'admin', 'Admin B·∫£o T√†ng', '0123456789', '123 ƒê∆∞·ªùng ABC', 'admin@example.com', 'admin')">S·ª≠a</button>
          <form action="chucnangthemsuaxoa_manageuser.php" method="POST" class="d-inline">
            <input type="hidden" name="action" value="delete">
            <input type="hidden" name="id_user" value="1">
            <button class="btn btn-danger btn-sm">X√≥a</button>
          </form>
        </td>
      </tr>
      <!-- Th√™m d√≤ng kh√°c n·∫øu c·∫ßn -->
    </tbody>
  </table>
</section>

<footer class="text-center mt-5">
  <p>¬© 2025 B·∫£o T√†ng B√πa Ch√∫ VN - Admin</p>
</footer>

<!-- Modal Th√™m -->
<div class="modal fade" id="addUserModal" tabindex="-1">
  <div class="modal-dialog">
    <form class="modal-content" action="chucnangthemsuaxoa_manageuser.php" method="POST">
      <input type="hidden" name="action" value="add">
      <div class="modal-header">
        <h5 class="modal-title">Th√™m ng∆∞·ªùi d√πng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-2">
          <label>Username</label><input type="text" name="username" class="form-control" required>
        </div>
        <div class="mb-2">
          <label>M·∫≠t kh·∫©u</label><input type="password" name="pass" class="form-control" required>
        </div>
        <div class="mb-2">
          <label>H·ªç t√™n</label><input type="text" name="ho_ten" class="form-control" required>
        </div>
        <div class="mb-2">
          <label>Email</label><input type="email" name="email" class="form-control" required>
        </div>
        <div class="mb-2">
          <label>SƒêT</label><input type="text" name="sdt" class="form-control">
        </div>
        <div class="mb-2">
          <label>ƒê·ªãa ch·ªâ</label><input type="text" name="dia_chi" class="form-control">
        </div>
        <div class="mb-2">
          <label>Quy·ªÅn</label>
          <select name="quyen" class="form-select">
            <option value="admin">Admin</option>
            <option value="khach">Kh√°ch</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success">L∆∞u</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal S·ª≠a -->
<div class="modal fade" id="editUserModal" tabindex="-1">
  <div class="modal-dialog">
    <form class="modal-content" action="chucnangthemsuaxoa_manageuser.php" method="POST">
      <input type="hidden" name="action" value="edit">
      <input type="hidden" name="id_user" id="edit_id_user">
      <div class="modal-header">
        <h5 class="modal-title">S·ª≠a ng∆∞·ªùi d√πng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-2">
          <label>H·ªç t√™n</label><input type="text" name="ho_ten" id="edit_ho_ten" class="form-control" required>
        </div>
        <div class="mb-2">
          <label>Email</label><input type="email" name="email" id="edit_email" class="form-control" required>
        </div>
        <div class="mb-2">
          <label>SƒêT</label><input type="text" name="sdt" id="edit_sdt" class="form-control">
        </div>
        <div class="mb-2">
          <label>ƒê·ªãa ch·ªâ</label><input type="text" name="dia_chi" id="edit_dia_chi" class="form-control">
        </div>
        <div class="mb-2">
          <label>Quy·ªÅn</label>
          <select name="quyen" id="edit_quyen" class="form-select">
            <option value="admin">Admin</option>
            <option value="khach">Kh√°ch</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success">C·∫≠p nh·∫≠t</button>
      </div>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
function editUser(id, username, ho_ten, sdt, dia_chi, email, quyen) {
  document.getElementById('edit_id_user').value = id;
  document.getElementById('edit_ho_ten').value = ho_ten;
  document.getElementById('edit_email').value = email;
  document.getElementById('edit_sdt').value = sdt;
  document.getElementById('edit_dia_chi').value = dia_chi;
  document.getElementById('edit_quyen').value = quyen;
  var editModal = new bootstrap.Modal(document.getElementById('editUserModal'));
  editModal.show();
}
</script>
<!-- jQuery CDN -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
function loadUsers() {
  $.getJSON('get_users.php', function(data) {
    let rows = '';
    data.forEach(user => {
      rows += `
        <tr>
          <td>${user.id_user}</td>
          <td>${user.username}</td>
          <td>${user.ho_ten}</td>
          <td>${user.email}</td>
          <td>${user.sdt}</td>
          <td><span class="badge bg-primary">${user.quyen}</span></td>
          <td>
            <form action="user_crud.php" method="POST" class="d-inline">
              <input type="hidden" name="action" value="delete">
              <input type="hidden" name="id_user" value="${user.id_user}">
              <button class="btn btn-danger btn-sm">X√≥a</button>
            </form>
          </td>
        </tr>
      `;
    });
    $('#userTableBody').html(rows);
  });
}

// Khi trang load xong ‚Üí t·ª± g·ªçi
$(document).ready(function() {
  loadUsers();
});
</script>

</body>
</html>
